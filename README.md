# multiclient-quiz
実験Cで作った。オーバーキルである。

以下はレポートからの抜粋。

---

## 概要
早押し形式でのクイズ大会をホストするサーバー及びクライアントのプログラム。

## サーバープログラムの機能
サーバープログラムは下記の役割を担う。
-	クライアントの管理
-	問題の管理
-	解答の処理
-	得点の管理

サーバーの接続はSocket通信を用いて行う。プログラムを起動するとまず参加者受付用のスレッドを、threadingを利用して作成したのち、問題の管理を行うモードに入る。ここでは問題の登録・削除・外部ファイルからの読み込み・書き出しなどが行える。なおこのモード中にも参加者はサーバーに接続することは可能であるが、大会が開始されていないため待機するようメッセージが表示される。

問題の管理を行うモードを終了する旨のコマンドを使用するとサーバープログラムはクイズ大会を開始する。このモードでは問題及びスコアボードを繰り返し提示する。

クライアントからの接続要求は上述の参加者受付用のスレッドにより処理される。接続要求を受信すると、クライアントとの通信用のスレッドをさらに作成する。このスレッドでは当該クライアントからの発言の処理を行う。クライアントから受信した発言のうち、初回の物についてはそのユーザーの名称として登録し、以降は全参加者へのブロードキャストを行う。クイズ大会が開始されている場合はそのテキストと出題中の問題の答えとの比較を行う。

クライアントとの切断処理についてはクライアントの情報を保持するクラスClientのオブジェクトに特殊メソッド__del__に実装することにより確実に行われるようにする。 クライアントが切断した場合はクライアントの一覧から削除するのみで切断が正常に行われる。

大会開始後も入力受付を継続しているのは、任意のタイミングでCtrl-Cによる例外KeyboardInterruptを発生させることができるようにするためである。なお、クライアント接続中にサーバーが終了した場合でも上述の特殊メソッドにより適切に切断処理が行われる。

## クライアントプログラムの機能
サーバープログラムは下記の役割を担う。
-	入力内容のサーバーへの送信
-	サーバーからのメッセージの表示

不正を防止するため、クライアントの担う役割は最小限にする。クライアントを起動すると、名前の入力を求め、これをサーバーに送信する。以後、プロンプトが表示されユーザーは任意に発言を行える。並行して、ユーザーはサーバーから送信されたテキストを表示し続ける。このテキストには、進行上のメッセージのほか、他ユーザーの発言内容なども含まれる。

サーバーと同様、Ctrl-Cを入力することにより終了する。

## 実行できるコマンド
本制作物については、クライアントはコマンド処理機構を有さず、以下は全てサーバーのコマンドであることにご留意いただきたい。また、すべてのコマンドは対話的に実装される。
-	add	問題を追加する。
-	remove	問題を削除する。
-	list	問題の一覧を表示する。
-	load	問題をファイルから入力する。形式はcsvとする。
-	save	問題をファイルに出力する。形式はcsvとする。
-	start	クイズ大会を開始する。
-	help	ヘルプを表示する。
